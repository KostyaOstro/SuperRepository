<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:700" rel="stylesheet">
    <style>
        * {
            font-family: 'Roboto Condensed', sans-serif;
        }
    </style>
</head>
<script>
    var canvas, ctx, canvas2, ctx2, canvas3, ctx3;
    var w = h = 1024;

    var time = 0;
    var gsc;
    var bgColor;


    window.onload = function () {

        // gsc = rSeed(5);

        // bgColor = rColor(gsc);
        canvas = document.createElement("canvas");
        canvas.width = w;
        canvas.height = h;
        document.body.appendChild(canvas);
        ctx = canvas.getContext("2d");
        //fractal.init();

        animate();

    }
    var fractal = {
        depth: rSeed(3) + 2,
        side: rSeed(5) + 3,
        get num() {
            var fac = 0;
            for (let jj = 0; jj < this.depth; jj++) {
                fac += Math.pow(this.side, jj)

            }
            return fac
        },
        radius: [],
        x: [],
        y: [],
        weight: [],
        angle: [],
        parent: [],
        string:[   
            "THERE'S",
            "SUGAR",
            "ON YOUR",
            "SOUL"],
        init() {
            this.x[0] = w / 2;
            this.y[0] = h / 2;
            this.radius[0] = w / 4;
            this.parent[0] = 0;
            this.angle[0] = Math.PI/2;
            var pow = 0;
            var check = 0;
            var index = 0;
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, w, h);
            ctx.strokeStyle = 'white';
            ctx.fillStyle = 'white';

            for (let j = 0; j < this.num; j++) {
               //ctx.globalCompositeOperation='luminosity';
                if (check == Math.pow(this.side, pow)) {
                    pow++
                    check = 0;
                }


                ctx.beginPath();
                var k = (Math.sin(time / 50 + j / this.num * 5) + 1) / 2 * 0.1;
                ctx.arc(
                    this.x[j],
                    this.y[j],
                    w / 4 / (pow + 1) * k,
                    0,
                    Math.PI * 2)
                ctx.closePath();
                ctx.stroke();


                ctx.beginPath();
                if(j>this.side+1){
                    var radius = w / 6 / (pow + 2) + w / 8 / (pow + 1) * Math.sin(time / 400 + j / this.num * 20);
                }else{
                    var radius = w / 6 / (pow + 2)+ w / 8 / (pow + 1) ;
                }
                
                for (let ii = 0; ii < this.side; ii++) {
                    index++;
                    this.parent[index] = j;
                    this.weight[index] = j;
                    this.angle[index] = Math.PI * 2 / this.side * ii + time / 500 / (pow + 1);

                    this.x[index] = this.x[j] + Math.cos(this.angle[index]) * radius;
                    this.y[index] = this.y[j] + Math.sin(this.angle[index]) * radius;
                    if (ii == 0) {
                        ctx.moveTo(this.x[index], this.y[index]);
                    } else {
                        ctx.lineTo(this.x[index], this.y[index]);
                    }
                    ctx.fillRect(this.x[index] - 3, this.y[index] - 3, 6, 6)
                    if ((j + ii) % 4 == 0) {
                        ctx.fillRect(this.x[index] - 6, this.y[index] - 6, 12, 12)
                    }

                }
                ctx.closePath();
                //ctx.lineWidth=Math.cos(j/this.num*10+time/80) +2;
                if (j % 29 == 0) {
                    ctx.fill();
                } else {
                    if (j % 4 == 0) {} else {
                        ctx.stroke();
                    }

                }

                check++
                ctx.beginPath();
                ctx.arc(
                    this.x[j],
                    this.y[j],
                    w / 120,
                    0,
                    Math.PI * 2)
                ctx.closePath();
                ctx.stroke();
                if (j % 13 == 0) {
                    ctx.strokeRect(this.x[j] - 20, this.y[j] - 20, 40, 40)
                }
                if (j % 17 == 3) {
                    ctx.fillStyle = "white";
                    ctx.beginPath();
                    ctx.arc(
                        this.x[j],
                        this.y[j],
                        w / 80,
                        0,
                        Math.PI * 2)
                    ctx.closePath();
                    ctx.fill();
                }
                if (j % 17 == 0) {
                    ctx.fillStyle = "white";
                    ctx.font = '12px Roboto Condensed';
                    ctx.fillText(Math.round(this.x[j] * 10) / 10, this.x[j], this.y[j])
                }

            }
            ctx.save();
            ctx.translate(w/2,h/2);
            ctx.rotate(time/1000);
            ctx.translate(-w/10,-h/20);
            ctx.fillStyle = "black";
            var fs=w/20;
            var lh=fs;
            ctx.font = fs+'px Roboto Condensed';
            for(let yy=0;yy<this.string.length;yy++){
                ctx.fillText(this.string[yy], 0, lh*yy)
            }
            ctx.restore();
        }
    }


    function draw() {
        fractal.init();
    }

    function animate() {
        clear();
        draw();
        window.requestAnimationFrame(animate);
        time++
    }

    function clear() {

        ctx.clearRect(0, 0, w, h);


        //ctx.clearRect(0, 0, w, h)
        //ctx.clearRect(0, 0, w, h)
    }

    function rColor(s) {
        var seed = Math.round(Math.random() * 4);
        var color = [];
        color[0] = ["#571845", "#900c3e", "#c70039", "#ff5733", "#ffc300"];
        color[1] = ["#96ceb4", "#ffeead", "#ff6f69", "#ffcc5c", "#88d8b0"];
        color[2] = ["#173f5f", "#20639b", "#3caea3", "#f6d55c", "#ed553b"];
        color[3] = ["#999", "#777", "#555", "#333", "#111"];
        var rgb = color[s][seed];
        return rgb;
    }

    function random(minR, maxR) {
        var r = minR + (maxR - minR) * Math.random();
        return r
    }

    function rSeed(value) {
        var seed = Math.round(Math.random() * value);
        return seed
    }

    function dist(x1, y1, x2, y2) {
        var dx = Math.abs(x1 - x2);
        var dy = Math.abs(y1 - y2);
        var d = Math.sqrt(dx * dx + dy * dy);
        return d
    }


    function rColor(s) {
        var seed = Math.round(Math.random() * 4);
        var color = [];
        color[0] = ["#571845", "#900c3e", "#c70039", "#ff5733", "#ffc300"];
        color[1] = ["#96ceb4", "#ffeead", "#ff6f69", "#ffcc5c", "#88d8b0"];
        color[2] = ["#173f5f", "#20639b", "#3caea3", "#f6d55c", "#ed553b"];
        color[3] = ["#999", "#777", "#555", "#333", "#111"];
        color[4] = ["#ffa239", "#c8e6c9", "#81c784", "#4caf50", "#ffe789"];
        color[5] = ["#428", "#6ca2ea", "#b5d33d", "#fed23f", "#eb7d5b"];
        var rgb = color[s][seed];
        return rgb;
    }
    document.addEventListener('mousemove', mmm);

    function mmm(e) {
        e = event || window.event;
        x = event.clientX;
        y = event.clientY;
        if (x > w) {
            x = w
        };
        if (y > h) {
            y = h
        };
        //console.log(x, y)
    };
</script>

<body>
    *
</body>

</html>