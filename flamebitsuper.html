<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script>
        var canvas, ctx;
        var w = h = 1024;
        var gsc;
        var time = 0;


        window.onload = function () {
            canvas = document.createElement("canvas");
            canvas.width = w;
            canvas.height = h;
            document.body.appendChild(canvas);
            ctx = canvas.getContext("2d");
            flame.init();
            animate();
        }
        var flame = {
            num: 32,
            maxLength: 32,
            e: [],

            step:16,
            tape: [],
            length: [],
            trigger: [],
            timer: [],

            init() {
                for (let i = 0; i < this.num; i++) {
                    this.trigger[i] = rSeed(100) + 50;
                    this.timer[i] = 0;
                    this.e[i] = [];
                    this.length[i] = Math.round(Math.sin(i / this.num * Math.PI) * this.maxLength) + rSeed(10) -
                        rSeed(20)
                    console.log(this.length[i])
                    for (let j = 0; j < this.maxLength; j++) {
                        this.e[i][j] = rSeed(this.step);

                    }

                }
            },
            draw() {
                if(time%3==0){
                ctx.clearRect(0, 0, w, h);

                for (let i = 0; i < this.num; i++) {
                    // if (this.timer[i] >= this.trigger[i]) {
                    //     this.trigger[i] = rSeed(100) + 50;
                    //     this.timer[i] = 0;
                    //     this.length[i] = Math.round(Math.sin(i / this.num * Math.PI) * this.maxLength) + rSeed(10) -
                    //         rSeed(20)
                    // }
                    this.length[i] = Math.round(Math.sin(i / this.num * Math.PI) * this.maxLength)+Math.round(Math.sin(time/60+i/this.num*20)*10)
                    for (let j = 0; j < this.maxLength; j++) {
                        if (j == (this.maxLength - 1)) {
                            this.e[i][j] =rSeed(this.step);
                        } else {
                            this.e[i][j] = this.e[i][j + 1];
                        }
                        var x = w / 2 - this.num / 2 * this.step + i * this.step;
                        var y = h * 1 / 6 + j * this.step;
                        if ((this.maxLength - j) < this.length[i]) {
                            ctx.fillRect(
                                x,
                                y,
                                this.e[i][j],
                                this.e[i][j]
                            )
                        }


                    }
                    this.timer[i]++
                }


            }
        }

        }

        function animate() {
            // ctx.fillStyle = "rgba(255,255,255,0.1)";

            flame.draw();
            var raf = requestAnimationFrame(animate);

            time++
        };

        function rColor(s) {
            var seed = Math.round(Math.random() * 4);
            var color = [];
            color[0] = ["#571845", "#900c3e", "#c70039", "#ff5733", "#ffc300"];
            color[1] = ["#96ceb4", "#ffeead", "#ff6f69", "#ffcc5c", "#88d8b0"];
            color[2] = ["#173f5f", "#20639b", "#3caea3", "#f6d55c", "#ed553b"];
            color[3] = ["#999", "#777", "#555", "#333", "#111"];
            color[4] = ["#ffa239", "#c8e6c9", "#81c784", "#4caf50", "#ffe789"];
            color[5] = ["#428", "#6ca2ea", "#b5d33d", "#fed23f", "#eb7d5b"];
            var rgb = color[s][seed];
            return rgb;
        };

        function random(minR, maxR) {
            var r = minR + (maxR - minR) * Math.random();
            return r
        };

        function rSeed(value) {
            var seed = Math.round(Math.random() * value);
            return seed
        };

        function dist(x1, y1, x2, y2) {
            var dx = Math.abs(x1 - x2);
            var dy = Math.abs(y1 - y2);
            var d = Math.max(dx, dy);
            return d
        }
    </script>
</head>

<body>

</body>

</html>