<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<script>
    var canvas, ctx, canvas2, ctx2, canvas3, ctx3;
    var w = h = 1024;

    var time = 0;
    var gsc;
    var bgColor;


    window.onload = function () {
        canvas = document.createElement("canvas");
        canvas.width = w;
        canvas.height = h;
        document.body.appendChild(canvas);
        ctx = canvas.getContext("2d");
        ctx.strokeRect(0, 0, w, h);
        tapes.init();
        ctx.textAlign = "center";
        animate();
        //tapes.draw();
    }
    var seed = rSeed(2) + 3;
    var tapes = {
        string: "STRANGE MACHINES ",
        gridH: seed,
        gridV: seed,
        maxN: rSeed(3) + 1,
        x: [],
        y: [],
        num: [],
        lw: [],
        angle: [],
        as: [],
        seed: [],
        size: [],
        init() {
            this.seed[0] = rSeed(5);
            this.seed[1] = rSeed(5);
            this.seed[2] = rSeed(2) + 1;
            this.seed[3] = rSeed(this.gridH * this.gridV);
            this.seed[4] = rSeed(5);
            for (let i = 0; i < this.gridH * this.gridV; i++) {
                this.x[i] = w / (this.gridH + 1) + w / (this.gridH + 1) * (i % this.gridH);
                this.y[i] = h / (this.gridV + 1) + h / (this.gridV + 1) * Math.floor(i / this.gridH);
                this.num[i] = rSeed(this.maxN) + 1;
                this.lw[i] = Math.round(w / (this.gridH + 1) / 2 / (this.maxN + 1));
                this.angle[i] = [];
                this.as[i] = [];
                this.size[i] = random(w / 120, w / 60);
                ctx.lineWidth = this.lw[i];

                for (let j = 0; j < this.num[i]; j++) {

                    this.angle[i][j] = rSeed(8) * Math.PI / 2;
                    this.as[i][j] = random(5, 100);
                }
            }
        },
        draw() {
            for (let i = 0; i < this.gridH * this.gridV; i++) {
                this.x[i] += Math.cos(time / 50 + i / this.gridH * this.gridV * 5) / 2;
                this.y[i] += Math.sin(time / 50 + i / this.gridH * this.gridV * 5) / 2;
                if (i % this.seed[2] == 0) {

                    ctx.lineWidth = this.lw[i];
                    for (let j = 0; j < this.num[i]; j++) {

                        var radius = w / (this.gridH + 1) / 2 / (this.maxN + 1) * j;
                        ctx.beginPath();
                        var speed = time / this.as[i][j];
                        ctx.arc(
                            this.x[i],
                            this.y[i],
                            radius,
                            speed,
                            speed + this.angle[i][j]
                        )

                        ctx.stroke();
                        var x = this.x[i] + radius * Math.cos(speed + this.angle[i][j]);
                        var y = this.y[i] + radius * Math.sin(speed + this.angle[i][j]);
                        ctx.fillStyle = "white";
                        ctx.save();
                        ctx.translate(x, y);
                        ctx.rotate(speed + this.angle[i][j]);
                        ctx.font = 'regular 10px arial';
                        ctx.fillText(
                            Math.floor((speed + this.angle[i][j]) * 100) / 100, 0, 0
                        );
                        ctx.restore()
                    }

                }
                if (i % this.seed[4] == 0) {
                    ctx.lineWidth = 1;
                    ctx.fillStyle = 'black';
                    ctx.fillRect(
                        this.x[i] - this.size[i] / 2,
                        this.y[i] - this.size[i] / 2,
                        this.size[i],
                        this.size[i],
                    );
                }
                if (i == this.seed[3]) {
                    for (let ii = 0; ii < this.string.length; ii++) {
                        var angle = time / 60 + ii / this.string.length * Math.PI * 2;
                        var x = this.x[i] + w / (this.gridH + 1) / 2 * Math.cos(angle);
                        var y = this.y[i] + w / (this.gridH + 1) / 2 * Math.sin(angle);
                        ctx.save();
                        ctx.translate(x, y);
                        ctx.rotate(angle + Math.PI / 2);
                        ctx.translate(-10, 0);
                        ctx.font = 'bold ' + w / 20 + 'px arial';
                        ctx.fillStyle = "black";
                        ctx.fillText(
                            this.string[ii], 0, 0
                        );
                        ctx.restore()
                    }

                }
                if ((this.gridH - i % this.gridH - 1) != 0 && Math.floor(i / this.gridH) < this.gridV) {
                    if (i % this.seed[0] == 0) {
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(this.x[i], this.y[i]);

                        ctx.lineTo(this.x[i + this.gridH + 1], this.y[i + this.gridH + 1]);
                        ctx.stroke()
                    }

                }
                if ((this.gridH - i % this.gridH) != this.gridH && Math.floor(i / this.gridH) < this.gridV) {
                    if (i % this.seed[1] == 0) {
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(this.x[i], this.y[i]);

                        ctx.lineTo(this.x[i + this.gridH - 1], this.y[i + this.gridH - 1]);
                        ctx.stroke()
                    }
                }
            }
        }

    }

    function draw() {
        tapes.draw();
    }

    function clear() {
        ctx.fillStyle='white';
        ctx.fillRect(0, 0, w, h);
    }

    function animate() {
        clear();
        draw();
        requestAnimationFrame(animate);
        time++
    }

    function rColor(s) {
        var seed = Math.round(Math.random() * 4);
        var color = [];
        color[0] = ["#571845", "#900c3e", "#c70039", "#ff5733", "#ffc300"];
        color[1] = ["#96ceb4", "#ffeead", "#ff6f69", "#ffcc5c", "#88d8b0"];
        color[2] = ["#173f5f", "#20639b", "#3caea3", "#f6d55c", "#ed553b"];
        color[3] = ["#999", "#777", "#555", "#333", "#111"];
        var rgb = color[s][seed];
        return rgb;
    }

    function random(minR, maxR) {
        var r = minR + (maxR - minR) * Math.random();
        return r
    }

    function rSeed(value) {
        var seed = Math.round(Math.random() * value);
        return seed
    }
</script>

<body>

</body>

</html>