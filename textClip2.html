<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:900" rel="stylesheet">
    <style>
        * {
            font-family: 'Roboto', sans-serif;
            padding: 0px;
            margin: 0px;
        }
    </style>
</head>
<script>
    var canvas, ctx, canvas2, ctx2;
    var w = 1200;
    var h = 1200;
    var time = 0;
    var globalSeedColor;

    window.onload = function () {
        globalSeedColor = rSeed(4);
        canvas = document.createElement('canvas');
        canvas.width = w;
        canvas.height = h;
        document.body.appendChild(canvas);
        ctx = canvas.getContext("2d");
        rect.init();
        animate();
    }

    var rect = {
        depth: rSeed(20),
        max: 0.5,
        x: [0],
        y: [0],
        w: [w],
        h: [h],
        init() {
            for (j = 0; j < this.depth; j++) {
                rectPic(this, j);
            }

            function rectPic(obj, index) {
                var l = obj.x.length - 1;
                var offsetX = obj.x[index];
                var offsetY = obj.y[index];
                var avW = obj.w[index];
                var avH = obj.h[index];
                for (i = 0; i < obj.depth; i++) {
                    if (i != index) {
                        obj.x[l + i] = offsetX;
                        obj.y[l + i] = offsetY;

                        if (rSeed(2) > 1) {
                            obj.w[l + i] = avW;
                            obj.h[l + i] = avH * obj.max * random(0.2, 1);
                            avH -= obj.h[l + i];
                            offsetY += obj.h[l + i];
                        } else {
                            obj.w[l + i] = avW * obj.max * random(0.2, 1);
                            obj.h[l + i] = avH;
                            avW -= obj.w[l + i];
                            offsetX += obj.w[l + i];
                        }
                    }
                    ctx.fillStyle = rColor(globalSeedColor);
                    ctx.fillRect(obj.x[l + i], obj.y[l + i], obj.w[l + i], obj.h[l + i]);
                    ctx.fillStyle = rColor(globalSeedColor);

                    var gco = [
                        "screen",
                        "lighter",
                        "multiply",
                        "overlay",
                        "darken",
                        "lighten"
                    ]

                    ctx.globalCompositeOperation = gco[rSeed(5)];

                    for (
                        jj = 0; jj < Math.floor((obj.h[l + i] / obj.w[l + i]) * random(0, 1)); jj++
                    ) {
                        ctx.beginPath();
                        ctx.arc(
                            obj.x[l + i] + obj.w[l + i] / 2,
                            obj.y[l + i] + obj.w[l + i] / 2 + obj.w[l + i] * jj,
                            obj.w[l + i] / 2,
                            0,
                            Math.PI * 2
                        );
                        ctx.closePath();
                        ctx.fill()

                        rColor(globalSeedColor);
                        for (kk = 0; kk < rSeed(3); kk++) {
                            var step = random(0, 0.5);
                            ctx.beginPath();
                            var r = obj.w[l + i] / 2 - obj.w[l + i] / 2 * step * kk;
                            if (r > 0) {
                                ctx.arc(
                                    obj.x[l + i] + obj.w[l + i] / 2,
                                    obj.y[l + i] + obj.w[l + i] / 2 + obj.w[l + i] * jj,
                                    r,
                                    0,
                                    Math.PI * 2
                                );
                                ctx.closePath();
                                ctx.fill()
                                ctx.restore();
                                ctx.save();
                            }
                            //}
                        }

                    }
                }
            }
        }
    }



    function draw() {

    }

    function dist(x, y, x1, y1) {
        var dx = x - x1;
        var dy = y - y1;
        var d = Math.sqrt(dx * dx + dy * dy);
        return d
    }

    function animate() {
        //clear();
        draw();
        //window.requestAnimationFrame(animate);
        time++
    }

    function clear() {
        ctx.clearRect(0, 0, w, h)
    }

    function rColor(s) {
        var seed = Math.round(Math.random() * 4);
        var color = [];
        color[0] = ["#571845", "#900c3e", "#c70039", "#ff5733", "#ffc300"];
        color[1] = ["#96ceb4", "#ffeead", "#ff6f69", "#ffcc5c", "#88d8b0"];
        color[2] = ["#173f5f", "#20639b", "#3caea3", "#f6d55c", "#ed553b"];
        color[3] = ["#999", "#777", "#555", "#333", "#111"];
        color[4] = ["#ffa239", "#c8e6c9", "#81c784", "#4caf50", "#ffe789"];
        color[5] = ["#428", "#6ca2ea", "#b5d33d", "#fed23f", "#eb7d5b"];
        var rgb = color[s][seed];
        return rgb;
    }

    //document.addEventListener('mousemove', mmm);

    function mmm(e) {
        e = event || window.event;
        x = event.clientX;
        y = event.clientY;
        if (x > w) {
            x = w
        };
        if (y > h) {
            y = h
        };
        //console.log(x, y)
    };

    function random(minR, maxR) {
        var r = minR + (maxR - minR) * Math.random();
        return r
    }

    function rSeed(value) {
        var seed = Math.round(Math.random() * value);
        return seed
    }
</script>

<body>
    55
</body>

</html>