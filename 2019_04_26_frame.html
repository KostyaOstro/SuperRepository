<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>2019-04-26_frame</title>
</head>
<script>
    var canvas, ctx;
    var mcanvas = [];
    var mctx = [];
    var time = 0;
    var w = h = 1024;

    var frame = {
        string: "ICQ",
        fs: h / 2,
        copies: 30,
        minSize: 0,
        maxSize: 1.3,
        init() {
            ctx.font ='bold ' + this.fs + "px arial"
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, w, h);
            ctx.fillStyle = 'white';
            ctx.fillText(
                this.string.toUpperCase(),
                w / 2,
                h / 2
            )
            for(let i = 0 ; i < this.copies; i++){
                mcanvas[i] = document.createElement("canvas");
                let w1 = (w - w * this.minSize) / this.copies * (this.copies - i) +  w * this.minSize;
                let h1 = (h - h * this.minSize) / this.copies * (this.copies - i) +  h * this.minSize
                mcanvas[i].width = w1;
                mcanvas[i].height = h1;
                //document.body.appendChild(mcanvas[i]);
                mctx[i] = mcanvas[i].getContext("2d");
                mctx[i].drawImage(
                    canvas,
                    (w - w * this.minSize) / this.copies * i / 2,
                    (h - h * this.minSize) / this.copies * i / 2,
                    w1,
                    h1,
                    0,
                    0,
                    w1,
                    h1
                )
                mctx[i].strokeStyle = 'white';
                mctx[i].strokeRect(
                    0,
                    0,
                    w1-2,
                    h1-2
                )
            }

        },
        animate() {
            
            for(let i = 0 ; i < this.copies; i++){
                ctx.save();
                ctx.translate(w / 2, h / 2);
                let angle = Math.cos(i / this.copies * 3 + time / 60) * Math.PI / 20;
                //console.log(angle);
                ctx.rotate(angle);
                let kx = Math.cos(i / this.copies * 7 + time / 100) * w / 15;
                let ky = Math.sin(i / this.copies * 7 + time / 100) * w / 15;
                let xx = (w - w * this.minSize) / this.copies * i / 2;
                let yy = (h - h * this.minSize) / this.copies * i / 2;
                ctx.translate(-w / 2 + kx, - h / 2 + ky);
                ctx.drawImage(
                    mcanvas[i],
                    xx,
                    yy,
                )
                ctx.fillStyle = "white";
                ctx.font = h / 100 + 'px arial';
                if(i % 3 == 0){
                    ctx.fillText(
                        Math.round(kx * 100) / 100,
                        xx,
                        yy
                    )
                }
                ctx.restore()
            }
        }
    }


    window.onload = function () {
        canvas = document.createElement("canvas");
        canvas.width = w;
        canvas.height = h;
        document.body.appendChild(canvas);
        ctx = canvas.getContext("2d");
        frame.init()
        animate()
    }
    function animate(){
        frame.animate();
        requestAnimationFrame(animate);
        time++
    }
</script>

<body>

</body>

</html>