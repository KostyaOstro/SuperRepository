<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="/javascripts/three.js"></script>
    <script src="/javascripts/myLib.js"></script>
    <title>Document</title>
    <script id='fragmentShader5' type='x-shader/x-fragment'>
        uniform float time;
        uniform sampler2D texture0;
        uniform sampler2D texture1;
        uniform sampler2D texture2;
        varying vec2 mv;
        varying vec3 p;
        varying vec4 n;

        mat2 rotation(float angle){
            return mat2(cos(angle), -sin(angle),
                        sin(angle), cos(angle));
        }

        void main(){
            vec2 mv1 = mv ;
            vec2 mv2 = mv ;
            mv2 -= .5;
            mv2 *= rotation(3.14 / 2.);
            mv2 += .5;
            mv2 = fract(mv2 * 1.);
            mv1 = fract(mv1 * 3.);
            vec4 img1 = texture2D(texture1, mv1);

            mv2.x += (1. - img1.r) / 60.;
            mv2.y -= mv2.x / 20. + cos(mv2.x * 7. + time) / 30.;
            vec4 img0 = texture2D(texture0, mv2);
            vec3 w = vec3(1., 1., .2);
            if(img0.r > .9) discard;
            if(!gl_FrontFacing) w *= .3;
            gl_FragColor = vec4(w, 1.);
        }

    </script>
    <script id='fragmentShader4' type='x-shader/x-fragment'>
        uniform float time;
        uniform sampler2D texture0;
        uniform sampler2D texture1;
        uniform sampler2D texture2;
        varying vec2 mv;
        varying vec3 p;
        varying vec4 n;


        void main(){
            vec2 mv2 = mv ;
          
            mv2 = fract(mv2 * 2.);
            vec4 img1 = texture2D(texture1, mv2);
            vec3 w = vec3(0., .2, .2);
            if(img1.r > .9) discard;
            if(!gl_FrontFacing) w *= .3;
            gl_FragColor = vec4(w, 1.);
        }

    </script>
    <script id='fragmentShader2' type='x-shader/x-fragment'>
        uniform float time;
        uniform sampler2D texture0;
        uniform sampler2D texture1;
        uniform sampler2D texture2;
        varying vec2 mv;
        varying vec3 p;
        varying vec4 n;

        void main(){
            vec2 mv2 = mv ;
            mv2 = fract(mv2 * 2.);
            vec4 img1 = texture2D(texture1, mv2);
            vec3 w = vec3(0., .3, .3);
            if(img1.r > .9) discard;
            if(!gl_FrontFacing) w *= .3;
            gl_FragColor = vec4(w, 1.);
        }

    </script>
    <script id='fragmentShader' type='x-shader/x-fragment'>
        uniform float time;
        uniform sampler2D texture0;
        uniform sampler2D texture1;
        uniform sampler2D texture2;
        varying vec2 mv;
        varying vec3 p;
        varying vec4 n;


        void main(){
            vec2 mv2 = mv ;
            mv2 = fract(mv2 * 2.);
            mv2.x = fract(mv2.x * 2.);
            vec4 img1 = texture2D(texture2, mv2);
            vec3 w = vec3(.3, .3, .7);
            if(img1.r < .4) discard;
            if(!gl_FrontFacing) w *= .3;
            gl_FragColor = vec4(w, 1.);
        }

    </script>
    <script id='fragmentShader3' type='x-shader/x-fragment'>
        uniform float time;
        uniform sampler2D texture0;
        uniform sampler2D texture1;
        uniform sampler2D texture2;
        varying vec2 mv;
        varying vec3 p;
        varying vec4 n;

        mat2 rotation(float angle){
            return mat2(cos(angle), -sin(angle),
                        sin(angle), cos(angle));
        }

        void main(){
            vec2 mv2 = mv ;
            mv2 -= .5;
            mv2 *= rotation(3.14 / 2.);
            mv2 += .5;
            mv2 = fract(mv2 * 2.);
            mv2.y = fract(mv2.y * 2.);
            vec4 img1 = texture2D(texture2, mv2);
            vec3 w = vec3(.1, .1, .5);
            if(img1.r < .4) discard;
            if(!gl_FrontFacing) w *= .3;
            gl_FragColor = vec4(w, 1.);
        }

    </script>
    <script id='vertexShader' type='x-shader/x-vertex'>
        uniform float time;
        uniform sampler2D texture1;
        varying vec2 mv;
        varying vec3 p;
        varying vec4 n;
        void main(){
            mv = uv;
            p = position;
            n =  modelViewMatrix * vec4(normal, 0.);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.);
        }

    </script>
</head>

<body>
    <script>
        var time = 0;
        var w = h = 1024;
        var uniforms;

        var canvas = document.createElement("canvas");
        canvas.width = w;
        canvas.height = h;
        var ctx = canvas.getContext("2d");
        //document.body.appendChild(canvas);

        var fs = h / 7;
        var lh = 1;
        var string = 'KONGOS';
        ctx.font = 'bold ' + fs + 'px Arial';
        ctx.textAlign = 'center';
        ctx.fillStyle = 'white';
        ctx.fillRect(0, 0, w, h);
        ctx.fillStyle = 'black';
        for(let i = 0; i < 7; i++){
            ctx.fillText(
                string,
                w / 2,
                (i + 1) * fs * lh
            )
        }
       


        if (ctx) {

            var scene = new THREE.Scene();
            var camera = new THREE.PerspectiveCamera(65, w / h, .01, 2000);
            camera.position.z = 75;
            var renderer = new THREE.WebGLRenderer();
            renderer.setSize(w, h);
            document.body.appendChild(renderer.domElement);

            var tex0 = new THREE.CanvasTexture(canvas);
            var tex1 = new THREE.TextureLoader().load("/images/jungle/1.png");
            var tex2 = new THREE.TextureLoader().load("/images/jungle/2.png");
            uniforms = {
                time: {
                    type: "f",
                    value: 0,
                },
                "texture0": {
                    value: tex0,
                },
                "texture1": {
                    value: tex1,
                },
                "texture2": {
                    value: tex2,
                },
            }
            var all = new THREE.Object3D();
            var geomtery = new THREE.CylinderGeometry(
                40, 
                40, 
                80, 
                20, 
                1,
                true,
                //0,
                //Math.PI / 2
                );
               
            var material = new THREE.ShaderMaterial({
                uniforms: uniforms,
                vertexShader: document.getElementById("vertexShader").textContent,
                fragmentShader: document.getElementById("fragmentShader").textContent,
                side: THREE.DoubleSide,
                //wireframe: true,
            })
            var sphere = new THREE.Mesh(geomtery, material);
            sphere.rotation.z = Math.PI / 2;
            sphere.rotation.x += Math.PI / 3.6  ;
            all.add(sphere);
            
            var geomtery = new THREE.CylinderGeometry(
                38, 
                38, 
                80, 
                20, 
                1,
                true,
                //0,
                //Math.PI / 2
                );
               
            var material = new THREE.ShaderMaterial({
                uniforms: uniforms,
                vertexShader: document.getElementById("vertexShader").textContent,
                fragmentShader: document.getElementById("fragmentShader3").textContent,
                side: THREE.DoubleSide,
                //wireframe: true,
            })
            var sphere = new THREE.Mesh(geomtery, material);
            sphere.rotation.z = Math.PI / 2;
            //sphere.rotation.x += Math.PI / 3  ;
            all.add(sphere);


            var geomtery = new THREE.CylinderGeometry(
                30, 
                30, 
                80, 
                20, 
                1,
                true,
                //0,
                //Math.PI / 2
                );
             
            var material = new THREE.ShaderMaterial({
                uniforms: uniforms,
                vertexShader: document.getElementById("vertexShader").textContent,
                fragmentShader: document.getElementById("fragmentShader2").textContent,
                side: THREE.DoubleSide,
                //wireframe: true,
            })
            var sphere = new THREE.Mesh(geomtery, material);
            sphere.rotation.z = Math.PI / 2;
            sphere.rotation.x += Math.PI / 3.6  ;
            all.add(sphere);
            
            var geomtery = new THREE.CylinderGeometry(
                28, 
                28, 
                80, 
                20, 
                1,
                true,
                //0,
                //Math.PI / 2
                );
             
            var material = new THREE.ShaderMaterial({
                uniforms: uniforms,
                vertexShader: document.getElementById("vertexShader").textContent,
                fragmentShader: document.getElementById("fragmentShader4").textContent,
                side: THREE.DoubleSide,
                //wireframe: true,
            })
            var sphere = new THREE.Mesh(geomtery, material);
            sphere.rotation.z = Math.PI / 2;
            sphere.rotation.x += Math.PI   ;
            all.add(sphere);


            var geomtery = new THREE.CylinderGeometry(
                39, 
                39, 
                80, 
                20, 
                1,
                true,
                0,
                Math.PI * 3 / 4
                );
             
            var material = new THREE.ShaderMaterial({
                uniforms: uniforms,
                vertexShader: document.getElementById("vertexShader").textContent,
                fragmentShader: document.getElementById("fragmentShader5").textContent,
                side: THREE.DoubleSide,
                //wireframe: true,
            })
            var sphere = new THREE.Mesh(geomtery, material);
            sphere.rotation.z = Math.PI / 2;
            sphere.rotation.x += Math.PI / 2.4 ;
            scene.add(sphere);

            
            scene.add(all);
            animate()
        }

        function animate() {
            all.rotation.x += 0.005;
            uniforms.time.value = time;
            renderer.render(scene, camera);
            requestAnimationFrame(animate);
            time += .01;
        }
    </script>
</body>

</html>