<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<script>
    var canvas, ctx, canvas2, ctx2;
    var sw = sh = 128;
    var scale = 10;
    var w = h = scale * sw;

    var time = 0;
    var gsc;
    var bgColor;


    window.onload = function () {
        gsc=rSeed(5);
        
        bgColor=rColor(gsc);
        console.log(bgColor);
        canvas2 = document.createElement("canvas");
        canvas2.width = sw;
        canvas2.height = sh;
        document.body.appendChild(canvas2);
        ctx2 = canvas2.getContext("2d");
        ctx2.strokeRect(0, 0, w, h);



        canvas = document.createElement("canvas");
        canvas.width = w;
        canvas.height = h;
        document.body.appendChild(canvas);
        ctx = canvas.getContext("2d");
        ctx.strokeRect(0, 0, w, h);

        ctx2.textAlign = "center";
        love.init();

        animate();

    }
    var love = {
        num: 256,
        string: [
            "FELL", "IN LOVE", "WITH", "GIRL"
        ],
        fs: sw / 4,
        lh: 1,
       
        x: [],
        y: [],
        l: [],
        size: [],
        as: [],
        x2: [],
        y2: [],
        l2: [],
        as2: [],
        seed: [],
        // angle:[],
        init() {
            this.borderC=rColor(gsc),
            this.fillC=rColor(gsc),
            ctx2.fillStyle = 'white';
            ctx2.fillRect(0, 0, w, h);
            for (let j = 0; j < this.string.length; j++) {

                ctx2.fillStyle = 'black';
                ctx2.font = 'bold ' + this.fs + 'px arial';
                ctx2.fillText(
                    this.string[j],
                    sw / 2,
                    -sh/50+this.fs + j * this.lh * this.fs)
            }
            var massive = ctx2.getImageData(0, 0, sw, sh);
            var data = massive.data;
            var i = 0;
            var i2 = 0;
            this.seed[0] = rSeed(5) + 1;
            this.seed[1] = rSeed(30) + 1;
            for (let jj = 0; jj < data.length; jj += 4) {
                if (data[jj] < 255) {
                    this.x[i] = jj / 4 % sw * scale;
                    this.y[i] = Math.floor(jj / 4 / sw) * scale;
                    this.l[i] = random(w / 80, w / 30);
                    this.size[i] = random(w / 400, w / 150);
                    this.as[i] = random(50, 100);
                    i++
                }else{
                    if(jj%this.seed[1]==0){
                        this.x2[i2] = jj / 4 % sw * scale;
                        this.y2[i2] = Math.floor(jj / 4 / sw) * scale;
                        this.l2[i2] = random(w / 80, w / 30)/2;
                        //this.size2[i] = random(w / 400, w / 150);
                        this.as2[i2] = random(50, 100);
                        i2++
                    }
                  
                }
            }

            



        },
        draw() {

            for (let i = 0; i < this.x.length; i++) {
                ctx.strokeStyle = this.borderC;
                ctx.beginPath();
                ctx.moveTo(this.x[i], this.y[i]);
                var angle = Math.cos(time / this.as[i]) * Math.PI / 6 - Math.PI / 2;
                var x = this.x[i] + Math.cos(angle) * this.l[i];
                var y = this.y[i] + Math.sin(angle) * this.l[i];
                ctx.lineTo(x, y);
                ctx.stroke();

                ctx.fillStyle = this.fillC;
                if (i % this.seed[0] == 0) {
                   
                    ctx.beginPath();
                    ctx.arc(x, y, this.size[i], 0, Math.PI * 2);
                    ctx.fill();
                    // ctx.stroke();
                }

            };
            for (let jj = 0; jj < this.x2.length; jj++) {
                ctx.beginPath();
                ctx.moveTo(this.x2[jj], this.y2[jj]);
                var angle = Math.cos(time / this.as2[jj]) * Math.PI / 6 - Math.PI / 2;
                var x = this.x2[jj] + Math.cos(angle) * this.l2[jj];
                var y = this.y2[jj] + Math.sin(angle) * this.l2[jj];
                ctx.lineTo(x, y);
                ctx.stroke();
            }

        }

    }

    function draw() {
        love.draw();
    }

    function clear() {
        ctx.fillStyle = bgColor;
        ctx.fillRect(0, 0, w, h);
    }

    function animate() {
        clear();
        draw();
        requestAnimationFrame(animate);
        time++
    }

    function rColor(s) {
        var seed = Math.round(Math.random() * 4);
        var color = [];
        color[0] = ["#571845", "#900c3e", "#c70039", "#ff5733", "#ffc300"];
        color[1] = ["#96ceb4", "#ffeead", "#ff6f69", "#ffcc5c", "#88d8b0"];
        color[2] = ["#173f5f", "#20639b", "#3caea3", "#f6d55c", "#ed553b"];
        color[3] = ["#999", "#777", "#555", "#333", "#111"];
        color[4] = ["#ffa239", "#c8e6c9", "#81c784", "#4caf50", "#ffe789"];
        color[5] = ["#428", "#6ca2ea", "#b5d33d", "#fed23f", "#eb7d5b"];
        var rgb = color[s][seed];
        return rgb;
    }

    function random(minR, maxR) {
        var r = minR + (maxR - minR) * Math.random();
        return r
    }

    function rSeed(value) {
        var seed = Math.round(Math.random() * value);
        return seed
    }
</script>

<body>

</body>

</html>