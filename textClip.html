<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:900" rel="stylesheet">
    <style>
        * {
            font-family: 'Roboto', sans-serif;
            padding: 0px;
            margin: 0px;
        }
    </style>
</head>
<script>
    var canvas, ctx, canvas2, ctx2;
    var w = 1200;
    var h = 1200;
    var time = 0;
    var globalSeedColor;
    var clipRect = [];
    var clips = 400;
    var offset = w / 40;
    var miniCanvas = [];
    var ctxminiCanvas = [];
    var bg;
    var x, y;
    window.onload = function () {
        globalSeedColor = Math.round(Math.random() * 3);
        canvas = document.createElement('canvas');
        canvas.width = w;
        canvas.height = h;
        // document.body.appendChild(canvas);
        ctx = canvas.getContext("2d");

        canvas3 = document.createElement('canvas');
        canvas3.width = w;
        canvas3.height = h;
         //document.body.appendChild(canvas3);
        ctx3 = canvas3.getContext("2d");



        var fs = w / 4;
        var lh = fs;
        ctx.font = (fs + 'px Roboto')
        //ctx.textAlign = "center";
        ctx.textBaseline = "middles";
        bg = rColor(globalSeedColor);

        ctx3.font = (fs + 'px Roboto')
        //ctx3.textAlign = "center";
        ctx3.textBaseline = "middles";



        var offs = w / 16;
        ctx.fillStyle = rColor(globalSeedColor);



        // ctx.fillText('TOUCH ME', w / 20, h / 2-lh/2);
        // ctx.fillText('GENTLY', w / 20, h / 2+lh/2);
        ctx.fillText('SPLIT////', w / 20, h / 2 - lh * 1.5 + offs);
        ctx.fillText('SPLIT////', w / 20, h / 2 - lh / 2 + offs);
        ctx.fillText('SPLIT///', w / 20, h / 2 + lh / 2 + offs);
        ctx.fillText('SPLIT///', w / 20, h / 2 + lh * 1.5 + offs);

        ctx3.fillStyle = rColor(globalSeedColor);

        ctx3.fillText('SPLIT////', w / 20, h / 2 - lh * 1.5 + offs);
        ctx3.fillText('SPLIT////', w / 20, h / 2 - lh / 2 + offs);
        ctx3.fillText('SPLIT///', w / 20, h / 2 + lh / 2 + offs);
        ctx3.fillText('SPLIT///', w / 20, h / 2 + lh * 1.5 + offs);


        canvas2 = document.createElement('canvas');
        canvas2.width = w;
        canvas2.height = h;
        document.body.appendChild(canvas2);
        ctx2 = canvas2.getContext("2d");
        ctx2.strokeRect(0, 0, w, h);
        // ctx2.fillStyle = ctx.fillStyle
        // ctx2.fillRect(0, 0, w, h);




        for (var j = 0; j < clips; j++) {
            iClip = {
                x: w / clips * j, //w / grid * k+Math.round(j%2)*w/grid/2,
                y: Math.random() * h, //h / grid / 2 * j,
                vx: Math.random() * 2 - 1,
                vy: Math.random() * 2 - 1,
                ww: h / 6 * Math.random() + h / 20, //+w/grid/2,
                type: Math.random() * 2,
                d: 100,
                init() {
                    miniCanvas[j] = document.createElement('canvas');
                    miniCanvas[j].width = this.ww;
                    miniCanvas[j].height = this.ww;
                    //document.body.appendChild(miniCanvas[j]);
                    ctxminiCanvas[j] = miniCanvas[j].getContext("2d");
                    //ctxminiCanvas[j].strokeRect(0,0,this.ww,this.ww);
                    //ctxminiCanvas[j].save();
                    if (this.type > 1) {
                        var region = new Path2D();
                        region.arc(
                            this.ww / 2,
                            this.ww / 2,
                            this.ww / 2,
                            0,
                            Math.PI * 2);
                        // region.arc(
                        //     this.ww / 2,
                        //     this.ww / 2,
                        //     this.ww / 2 - Math.random() * this.ww / 20,
                        //     0,
                        //     Math.PI * 2);

                        ctxminiCanvas[j].lineWidth = 1;

                        ctxminiCanvas[j].strokeStyle = bg; // rColor(globalSeedColor);
                        //ctxminiCanvas[j].stroke(region);
                        ctxminiCanvas[j].clip(region, "evenodd");
                    } else {
                        var side = this.ww / 2;
                        var pin = this.ww / 4;
                        var region = new Path2D();
                        //region.beginPath();
                        region.moveTo(0, side);
                        region.lineTo(side, 0);
                        region.lineTo(side * 2, side);
                        region.lineTo(side, side * 2);

                        // region.moveTo(pin, side);
                        // region.lineTo(side, pin);
                        // region.lineTo(side * 2 - pin, side);
                        // region.lineTo(side, side * 2 - pin);
                        //ctxminiCanvas[j].closePath();

                        ctxminiCanvas[j].lineWidth = 1;
                        ctxminiCanvas[j].strokeStyle = bg; // rColor(globalSeedColor);
                        //ctxminiCanvas[j].stroke(region)
                        ctxminiCanvas[j].clip(region, "evenodd");
                        // ctxminiCanvas[j].clip();
                    }
                    var seed2 = Math.random() * 2;
                    if (seed2 > 1) {
                        ctxminiCanvas[j].drawImage(
                            canvas3,
                            this.x - this.ww / 2,
                            this.y - this.ww / 2,
                            this.ww,
                            this.ww,
                            0,
                            0,
                            this.ww,
                            this.ww);
                    } else {
                        ctxminiCanvas[j].drawImage(
                            canvas,
                            this.x - this.ww / 2,
                            this.y - this.ww / 2,
                            this.ww,
                            this.ww,
                            0,
                            0,
                            this.ww,
                            this.ww);
                    }

                },
                draw(n) {
                    this.d = dist(this.x, this.y, x, y);
                    var ofin = 1 / this.d / this.d;
                    // console.log(ofin);
                    var x0 = this.vx * ofin * w * 200;
                    var y0 = this.vy * ofin * w * 200;

                    ctx2.drawImage(
                        miniCanvas[n],
                        this.x + x0 - this.ww / 2,
                        this.y + y0 - this.ww / 2
                    )


                }
            }
            clipRect.push(iClip)
        }
        for (var j = 0; j < clips; j++) {
            clipRect[j].init();
        }
        animate();
    }

    var grid = 4;

    function draw() {
        ctx2.fillStyle = bg;
        ctx2.fillRect(0, 0, w, h);
        // ctx2.globalCompositeOperation = 'luminosity';
        //offset = Math.cos(time / 50) * w / 20;
        for (var j = 0; j < clips; j++) {
            clipRect[j].draw(j)
        }
    }

    function dist(x, y, x1, y1) {
        var dx = x - x1;
        var dy = y - y1;
        var d = Math.sqrt(dx * dx + dy * dy);
        return d
    }

    function animate() {
        clear();
        draw();
        window.requestAnimationFrame(animate);
        time++
    }

    function clear() {
        ctx2.clearRect(0, 0, w, h)
    }

    function rColor(s) {
        var seed = Math.round(Math.random() * 4);
        var color = [];
        color[0] = ["#571845", "#900c3e", "#c70039", "#ff5733", "#ffc300"];
        color[1] = ["#96ceb4", "#ffeead", "#ff6f69", "#ffcc5c", "#88d8b0"];
        color[2] = ["#173f5f", "#20639b", "#3caea3", "#f6d55c", "#ed553b"];
        color[3] = ["#999", "#777", "#555", "#333", "#111"];
        var rgb = color[s][seed];
        return rgb;
    }

    document.addEventListener('mousemove', mmm);

    function mmm(e) {
        e = event || window.event;
        x = event.clientX;
        y = event.clientY;
        if (x > w) {
            x = w
        };
        if (y > h) {
            y = h
        };
        //console.log(x, y)
    };
</script>

<body>
    55
</body>

</html>