<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:900" rel="stylesheet">
</head>
<style>
    *{
        font-family: 'Roboto', sans-serif;
    }
</style>
<script>
    var mcanvas = [];
    var mctx = [];
    var ctx, canvas;
    var sctx, scanvas;
    var w = h = 1024;
    var time = 0;
    window.onload = function () {
        scanvas = document.createElement("canvas");
        scanvas.width = w;
        scanvas.height = h;
        //document.body.appendChild(scanvas);
        sctx = scanvas.getContext("2d");


        canvas = document.createElement("canvas");
        canvas.width = w;
        canvas.height = h;
        document.body.appendChild(canvas);
        ctx = canvas.getContext("2d");

        heroTitle.draw();
        clipCanvases.init();

        animate();
    }

    function animate() {
        clipCanvases.draw();
        requestAnimationFrame(animate)
        time++
    }

    function initmCanvases(index, r) {
        mcanvas[index] = document.createElement("canvas");
        mcanvas[index].width = r;
        mcanvas[index].height = r;
        //document.body.appendChild(mcanvas[index]);
        mctx[index] = mcanvas[index].getContext("2d");
    }
    var clipCanvases = {
        num: 32,
        r: [],
        as: [],
        a: [],
        init() {
            for (let i = 0; i < this.num; i++) {
                var radius = w / 2 / this.num * (this.num - i);
                this.r[i] = radius;
                initmCanvases(i, radius * 2);
                mctx[i].beginPath();
                mctx[i].arc(
                    radius,
                    radius,
                    radius,
                    0,
                    Math.PI * 2
                )
                mctx[i].clip()
                mctx[i].drawImage(
                    scanvas,
                    w / 2 - radius,
                    h / 2 - radius,
                    radius * 2,
                    radius * 2,
                    0,
                    0,
                    radius * 2,
                    radius * 2,
                )
                mctx[i].restore();
                mctx[i].strokeStyle = 'white';
                mctx[i].stroke()
                if (i < this.num - 5) {
                    var ms = w / 2 / this.num / 2;
                    var seedN = rSeed(20);
                    var seedA = random(0, Math.PI * 2);
                    var step = Math.PI * rSeed(2) / seedN;
                    for (let ii = 0; ii < seedN; ii++) {
                        var angle = step * ii + seedA;
                        var x = Math.cos(angle) * (radius - ms) + radius;
                        var y = Math.sin(angle) * (radius - ms) + radius;
                        mctx[i].beginPath();
                        mctx[i].arc(
                            x,
                            y,
                            ms /2*(0.1+Math.abs(Math.cos(ii/seedN*3))),
                            0,
                            Math.PI * 2
                        )
                        mctx[i].fillStyle = "white";
                        if(ii%3==0){
                            mctx[i].fill()
                        }else{
                            mctx[i].stroke()
                        }
                        
                    }
                }

            }

        },
        draw() {

            for (let i = 0; i < this.num; i++) {
                var x = w / 2 - this.r[i];
                var y = h / 2 - this.r[i];
                ctx.save();
                ctx.translate(w / 2, h / 2);
                ctx.rotate(Math.cos(time / 50 + i / this.num));
                ctx.translate(-this.r[i], -this.r[i]);
                ctx.drawImage(
                    mcanvas[i],
                    0,
                    0
                )
                ctx.restore();
            }
        }

    }
    var heroTitle = {
        back: "black",
        fill: "white",
        string: [
            "I WANT",
            "TO HYPNOTIZE",
            "YOU BABY",
            "ON THE",
            "TELEPHONE"
        ],
        fs: h / 8,
        lh: 1,
        draw() {
            sctx.fillStyle = this.back;
            sctx.fillRect(0, 0, w, h);
            sctx.fillStyle = this.fill;
            sctx.font = 'bold ' + this.fs + 'px ROBOTO';
            sctx.textAlign = "center";
            for (let ii = 0; ii < this.string.length; ii++) {
                sctx.fillText(
                    this.string[ii],
                    w / 2,
                    w / 6 + this.fs + this.fs * this.lh * ii
                )
            }

            // for (let j = 0; j < 24; j++) {
            //     var size = random(w / 50, w / 20);
            //     sctx.beginPath();
            //     sctx.strokeStyle="white";
            //     sctx.lineWidth=4;
            //     sctx.arc(
            //         random(0, w),
            //         random(0, h),
            //         size,
            //         0,
            //         Math.PI * 2
            //     )
            //     sctx.stroke()
            // }
        }
    }

    function rColor(s) {
        var seed = Math.round(Math.random() * 4);
        var color = [];
        color[0] = ["#571845", "#900c3e", "#c70039", "#ff5733", "#ffc300"];
        color[1] = ["#96ceb4", "#ffeead", "#ff6f69", "#ffcc5c", "#88d8b0"];
        color[2] = ["#173f5f", "#20639b", "#3caea3", "#f6d55c", "#ed553b"];
        color[3] = ["#999", "#777", "#555", "#333", "#111"];
        color[4] = ["#ffa239", "#c8e6c9", "#81c784", "#4caf50", "#ffe789"];
        color[5] = ["#428", "#6ca2ea", "#b5d33d", "#fed23f", "#eb7d5b"];
        var rgb = color[s][seed];
        return rgb;
    }

    function random(minR, maxR) {
        var r = minR + (maxR - minR) * Math.random();
        return r
    }

    function rSeed(value) {
        var seed = Math.round(Math.random() * value);
        return seed
    }
</script>

<body>
    *
</body>

</html>