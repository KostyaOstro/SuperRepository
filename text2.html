<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:900" rel="stylesheet">
</head>
<script>
    var time = 0;
    var canvas, ctx;
    var w = h = 1024;
    var gsc, bg;
    window.onload = function () {
        gsc = rSeed(5);
        bg = rColor(gsc);
        canvas = document.createElement("canvas");
        canvas.width = w;
        canvas.height = h;
        document.body.appendChild(canvas);
        ctx = canvas.getContext("2d");
        ctx.textAlign = "center";
        liquid.init();
        animate()
    }
    var liquid = {
        string: ["PERFECT", "CIRCLE"],
        fs: h / 8,
        lh: 1.2,
        circle: rSeed(50) + 3,
        parents: rSeed(40) + 3,
        points: rSeed(16) + 3,
        r: w / 3,
        delta: random(0.1, 0.8),
        a: [],
        l: [],
        x: [],
        y: [],
        s: [],
        seed: [],
        seed2: [],
        seed3: [],
        seed4: [],
        color1: [],
        color2: [],

        init() {
            ctx.beginPath();
            ctx.arc(w / 2, h / 2, this.r, 0, Math.PI * 2)
            ctx.stroke();
            var step = Math.PI * 2 / this.parents;
            ctx.strokeRect(w / 2, h / 2, 5, 5);
            for (let ii = 0; ii < this.circle; ii++) {
                this.a[ii] = [];
                this.l[ii] = [];
                this.x[ii] = [];
                this.y[ii] = [];
                this.seed[ii] = rSeed(20) + 6;
                this.seed2[ii] = rSeed(20) + 6;
                this.seed3[ii] = rSeed(2) + 2;
                this.seed4[ii] = rSeed(20) + 6;
                this.s[ii] = rSeed(20) + 4;
                this.color1[ii] = rColor(gsc);
                this.color2[ii] = rColor(gsc);
                for (let i = 0; i <= this.parents; i++) {
                    this.x[ii][i] = [];
                    this.y[ii][i] = [];
                    this.a[ii][i] = step * i;
                    if (i != this.parents) {
                        this.l[ii][i] = this.delta * Math.random() * this.r - this.delta / 2 * this.r + this.r;
                        var x = Math.cos(this.a[ii][i]) * this.l[ii][i] + w / 2;
                        var y = Math.sin(this.a[ii][i]) * this.l[ii][i] + h / 2;
                        ctx.fillRect(x, y, 5, 5);
                    }
                    this.l[ii][this.parents] = this.l[ii][0]

                };
            }
        },
        draw() {
            // ctx.beginPath();
            // ctx.arc(w / 2, h / 2, this.r, 0, Math.PI * 2)
            // ctx.stroke();
            ctx.font = 'bold ' + this.fs + 'px Roboto';
            var ofY = h / 2.2;
            ctx.strokeText(
                this.string[0],
                w / 2,
                ofY
            )
            ctx.strokeText(
                this.string[1],
                w / 2,
                ofY + this.fs * this.lh
            )

            var step = Math.PI * 2 / this.parents;
            //ctx.strokeRect(w / 2, h / 2, 5, 5)
            for (let ii = 0; ii < this.circle; ii++) {
                ctx.strokeStyle = this.color1[ii];
                ctx.fillStyle = this.color2[ii];
                for (let i = 0; i <= this.parents; i++) {

                    this.a[ii][i] = step * i;
                    if (i != this.parents) {
                        this.l[ii][i] += Math.sin(time / 50 + i + ii);
                        var x = Math.cos(this.a[ii][i]) * this.l[ii][i] + w / 2;
                        var y = Math.sin(this.a[ii][i]) * this.l[ii][i] + h / 2;
                        //ctx.fillRect(x, y, 5, 5);
                    }
                    this.l[ii][this.parents] = this.l[ii][0]
                    if (i != 0) {
                        for (let j = 0; j <= this.points; j++) {
                            var index = this.points * i + j;
                            var angle = this.a[ii][i - 1] + step / this.points * j;
                            var delta0 = this.l[ii][i] - this.r;
                            var delta1 = this.l[ii][i - 1] - this.r;



                            var p = Math.sin(j / this.points * Math.PI / 2);
                            var length = delta0 * p + delta1 * (1 - p) + this.r;
                            this.x[ii][i][index] = Math.cos(angle) * length + w / 2;
                            this.y[ii][i][index] = Math.sin(angle) * length + h / 2;
                            var s = Math.cos(index / this.points / this.parents * 8 + time / 50 + ii / 5) * this.s[
                                ii];
                            if (index % this.seed3[ii] == 0) {
                                ctx.fillRect(this.x[ii][i][index], this.y[ii][i][index], s, s);
                            } else {
                                ctx.strokeRect(this.x[ii][i][index], this.y[ii][i][index], s, s);
                            }

                            if (index % this.seed[ii] == 0 && j != 0) {
                                ctx.beginPath();
                                ctx.arc(this.x[ii][i][index], this.y[ii][i][index], this.s[ii] + Math.cos(j * i + j +
                                    time / 50) * this.s[ii] / 2, 0, Math.PI * 2)
                                ctx.stroke();
                            }

                        }
                    }



                };
            }
        }
    }

    function animate() {
        ctx.fillStyle = bg;
        ctx.fillRect(0, 0, w, h);
        liquid.draw();
        time++;
        requestAnimationFrame(animate)
    }

    function rColor(s) {
        var seed = Math.round(Math.random() * 4);
        var color = [];
        color[0] = ["#571845", "#900c3e", "#c70039", "#ff5733", "#ffc300"];
        color[1] = ["#96ceb4", "#ffeead", "#ff6f69", "#ffcc5c", "#88d8b0"];
        color[2] = ["#173f5f", "#20639b", "#3caea3", "#f6d55c", "#ed553b"];
        color[3] = ["#999", "#777", "#555", "#333", "#111"];
        color[4] = ["#ffa239", "#c8e6c9", "#81c784", "#4caf50", "#ffe789"];
        color[5] = ["#428", "#6ca2ea", "#b5d33d", "#fed23f", "#eb7d5b"];
        var rgb = color[s][seed];
        return rgb;
    };

    function random(minR, maxR) {
        var r = minR + (maxR - minR) * Math.random();
        return r
    };

    function rSeed(value) {
        var seed = Math.round(Math.random() * value);
        return seed
    };
</script>

<body>
*
</body>

</html>